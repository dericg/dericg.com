mailster=function(t,e,a,s){"use strict";var i=e("#singletest").val()||null,n=e(".start-test"),r=e(".tests-output"),o=e(".tests-textoutput"),l=e(".tests-wrap"),c=e(".test-info"),u=e("#progress"),h=u.find(".bar"),f=e("#outputnav"),d=e(".subtab"),m,g;n.on("click",function(){n.hide();u.show();r.empty();o.val(o.data("pretext"));g=1;v(i);m={error:0,warning:0,notice:0,success:0};return false});r.on("click","a",function(){if(this.className.match(/retest/))return true;if(this.className.match(/mailster-help/))return true;if(this.href)a.open(this.href);return false});l.on("change","input",function(){e(this).is(":checked")?l.removeClass("no-"+e(this).data("type")):l.addClass("no-"+e(this).data("type"))});f.on("click","a.nav-tab",function(){f.find("a").removeClass("nav-tab-active");d.hide();var a=e(this).addClass("nav-tab-active").attr("href");location.hash=a;e("#subtab-"+a.substr(1)).show();if(a=="#systeminfo"){var s=e("#system_info_content");if(t.util.trim(s.val()))return;s.val("...");t.util.ajax("get_system_info",function(e){if(e.data.log)t.log(e.data.log);s.val(e.data.msg)})}return false});if(/autostart/.test(location.search)){n.trigger("click")}else{location.hash&&f.find('a[href="'+location.hash+'"]').length?f.find('a[href="'+location.hash+'"]').trigger("click"):f.find("a").eq(0).trigger("click")}function v(a){t.util.ajax("test",{test_id:a},function(a){m["error"]+=a.data.errors.error;m["warning"]+=a.data.errors.warning;m["notice"]+=a.data.errors.notice;m["success"]+=a.data.errors.success;e(a.data.message.html).appendTo(r);o.val(o.val()+a.data.message.text);if(a.data.nexttest&&!i){h.width(++g/a.data.total*100+"%");c.html(t.util.sprintf(t.l10n.tests.running_test,g,a.data.total,a.data.next))}else{h.width("100%");setTimeout(function(){n.html(t.l10n.tests.restart_test).show();u.hide();h.width(0);c.html(t.util.sprintf(t.l10n.tests.tests_finished,m.error,m.warning,m.notice))},500)}if(a.data.nexttest&&!i){setTimeout(function(){v(a.data.nexttest)},100)}else{}},function(t,e,a){})}return t}(mailster||{},jQuery,window,document);